---
title: "Dimorphisme sexuel chez les serpents de mer"
author: "Léa Brohez, Amélie Pierson, Théa Rousseau, Pierre Martin"
format:
  html:
    code-fold: true
    code-tools: true
    toc: true
editor: visual
lang: fr
bibliography: references.bib
---

<!--# Ceci est un commentaire. -->

<!--% Ceci est une consigne. Ne jamais modifier ni déplacer les consignes dans le document ! -->

<!--% Complétez le titre et le nom des auteurs (auteur1, auteur2, auteur3 et auteur 4) dans l'entête YAML.-->

## Introduction et but

<!--% Rédigez une courte introduction de 3 ou 5 phrases qui présente vos données. Ajoutez une phrase de but (que vous remanierez éventuellement en fonction des modèles que vous ajouterez plus tard). Vous pouvez citer la bibliographie en utilisant le formatage Markdown ad hoc et en incluant votre référence au format bibtex dans le fichier references.bib. -->

La transition évolutive de la vie terrestre à la vie aquatique à transformé la morphologie et l'écologie de beaucoup d'espèces de serpents marins. Notamment chez les serpents hydrophiines élapidés et plus précisément les serpents aïpysurine des genres *Emydocephalus* et *Aipysurus*, chez qui l'adaptation à la vie marine aurait pu modifier la sélection naturelle et sexuelle. Ces différents changements s'expriment par un dimorphisme sexuel, c'est à dire par des différences morphologiques entre les individus mâles et femelles.

L'étude de ce dimorphisme nous permettrait de comprendre les contraintes écologiques et comportementales qui feraient évoluer les espèces marines. En particulier, leur morphologie corporelle qui peut nous montrer l'impact des différentes sélections liées à la vie marine.

Le but de cette analyse est de quantifier et modéliser le dimorphisme sexuel chez plusieurs espèces de serpents marins des genres *Emydocephalus* et *Aipysurus* et de déterminer l'influence des sélections sur ces serpents à partir des données mesurées sur différents individus.

<!--% Indiquez ici d'où viennent les données et aussi quel logiciel (et version) vous utilisez pour les analyses. Inspirez-vous des projets du premier module de SDD II. -->

...Matériel et méthodes...

## Analyses

```{r setup, include=FALSE}
# Ceci est nécessaire pour les tests SDD, ne pas utiliser dans un "vrai" projet
if (!"tools:tests" %in% search())
  source(here::here("tests/tools_tests.R"), attach(NULL, name = "tools:tests"))

# Configure Knitr to use AGG as graphic device
knitr::opts_chunk$set(dev = "ragg_png")

# Configuration de l'environnement
SciViews::R("model", lang = "fr")
```

<!--% Importez les données que vous aurez préalablement nettoyées, remaniées et labélisées dans le script R nommé `R/import.R`. -->

```{r import}
# Lecture des données
sea_snake1 <- read$rds("data/sea_snake1.rds")
# Tableau des premières et dernières lignes
tabularise$headtail(sea_snake1)
```

### Description des données

<!--% Chaque étudiant réalise et interprète un graphique pertinent en lien avec le but fixé et les modèles qui seront réalisés. Graphique et interprétation de l'étudiant #1 ci-dessous. -->

```{r chart1}
chart(data=sea_snake1, tail_length~tail_width_max %col=% sex |species  )+
  geom_point(alpha=0.5)
```

Ce graphique montre la relation entre la longueur et la largeur de la queue pour les six espèces de serpents marins étudiées, permettant ainsi d'évaluer le dimorphisme sexuel lié à ces variables pour chacune des espèces.

Pour l'ensemble des six espèces on observe une corrélation positive entre la longueur et la largeur de la queue : plus la celle-ci est longue, plus elle est large. Cependant, on observe aussi que les nuages de points varient d'une espèce à l'autre, montrant ainsi une différence dans les dimensions de la queue en fonction des espèces. Par exemple, on voit bien que *eydouxii* et *laevis* présentent des valeurs plus élevées pour ces deux variables (queue plus grande) que *annulatus* et *foliosquama*.

En ce qui concerne les différences entre sexes, le graphique montre que les distributions de longueur et de largeur de queue sont très similaires (les points se chevauchent), mais l'ampleur de ce dimorphisme sexuel varie d'une espèce à l'autre.

Pour *laevis* et *duboisii*, ce sont généralement les mâles qui présentent les valeurs les plus élevées pour l'une ou les deux variables. A l'inverse, pour *eydouxii* ce sont les femelles qui atteignent les plus grandes dimensions de queue. Ces différences montrent un dimorphisme sexuel dont l'orientation varie. De plus, pour ces espèces ainsi que *annulatus*, à largeur équivalente, les mâles possèdent une queue plus longue que les femelles.

Pour *foliosquama* et *fuscus*, les nuages de points des différents sexes sont presque entièrement superposés sans séparation marquée. Ceci implique que, dans ces espèces, la morphologie des mâles et des femelles est relativement similaire, et il n'y a donc pas ou peu de dimorphisme observable pour ces deux variables.

<!--% Graphique et interprétation de l'étudiant #2 ci-dessous. -->

```{r chart2}
#chart(data = sea_snake1, body_width ~ svl %col=% sex %shape=% genus | species ) +
#geom_point()
chart(data = sea_snake1, body_width ~ svl %col=% species %shape=% sex | genus ) +
  geom_point(alpha = 0.5)
#chart(data = sea_snake1, ~ body_width %fill=% species %shape=% sex | genus) + 
#geom_bar()
```

On peut voir que le gène Alpysurus est beaucoup plus abondant que l'autre

Il y a autant de mâle que de femelle, c'est assez bien équilibré

L'espèce laevis a une largeur de corp beaucoup plus grande que lers autres

Il n'y a qu'une seule espèce qui porte le gène Emydocephalus

<!--% Graphique et interprétation de l'étudiant #3 ci-dessous. -->

```{r chart3}
chart(data = sea_snake1, head_length ~ head_width %col=% sex | species) +
  geom_point(alpha= 0.5) 
```

... interprétation #3...

<!--% Graphique et interprétation de l'étudiant #4 ci-dessous. -->

```{r chart4}
#Pierre Martin
sea_snake1$nom_scientifique <- factor(paste(sea_snake1$genus, sea_snake1$species))
sea_snake1$sexe_et_age <- factor(paste(sea_snake1$sex, sea_snake1$adult))

chart(data = sea_snake1, eye_diam ~ adult %fill=% sexe_et_age | nom_scientifique) +
  geom_boxplot() +
   xlab("Age")

 #chart(data = sea_snake1, eye_diam ~ sexe_et_age %fill=% sexe_et_age | nom_scientifique) +
#  geom_boxplot()

# chart(data = sea_snake1, eye_diam ~ adult %fill=% nom_scientifique | sex) +
#  geom_boxplot()

# chart(data = sea_snake1, eye_diam ~ head_width %col=% nom_scientifique %shape=% sexe_et_age) +
#  geom_point(alpha = 0.50)

# chart(data = sea_snake1, eye_diam ~ head_width %col=% sexe_et_age | nom_scientifique) +
#  geom_point(alpha = 0.50)

# Les autres graphiques ont été gardés pour montrer les différents essais.
# Une boîte à moustache a été gardée pour ne pas avoir que des nuages de points.
```

Chez Aipysurus duboisii, les individus ont un diamètre des yeux médians similaires indépendamment de l'âge et du sexe. Un individu femelle adulte à son diamètre des yeux supérieur à la médiane plus d'1.5 fois supérieur à l'écart interquartile.

Chez Aipysurus eydouxii, les mâles ont des yeux plus grand que les femelles pour dans leur catégorie d'âge. Les diamètres médians des yeux sont plus élevés chez les adultes que chez les jeunes.

Chez Aipysurus follosquama, les femelles adultes ont des yeux plus grand que les mâles adultes sans prendre en compte les valeurs en dehors de l'écart interquartile. C'est l'opposé chez les jeunes où les mâles ont des yeux plus gros que les femelles.

Chez Aipysurus fuscus, les adultes ont une valeur médiane similaire pour le diamètre des yeux mais les mâles ont une plus grande variation de aille supérieure à la médiane.

Chez Aipysurus laevis, les femelles ont des yeux plus grand que les mâles pour dans leur catégorie d'âge.

Chez Emydocephalus annulatus, les adultes ont un diamètre des yeux médian similaire tandisque chez les jeunes les mâles ont des yeux plus grand que les femelles.

### Modélisation

<!--% Chaque modèle doit être décrit à l'aide d'un graphique et d'un tableau résumant le modèle. Les équations paramétrées de tous les modèles doivent être également présentes. L'analyse des résidus sera réalisée et interprétée pour chaque modèle. -->

#### Régression linéaire 1

<!--% Ajustez une régression linéaire simple, multiple ou polynomiale par paire d'étudiants dans cette section (donc, deux modèles pour l'équipe de quatre). -->

```{r lms1Lea-Amelie}
snake_lm1 <- lm(data = sea_snake1, tail_length ~ body_width)
summary(snake_lm1) |> tabularise()
```

-   Le modèle de régression linéaire est hautement significatif (Statistique F = 836.7, p\<2.22e-16). Ceci indique que la relation entre ces deux variables n'est pas due au hasard.

-   La largeur du corps est un excellent prédicteur de la longueur de la queue. Le coefficient de détermination multiple (R\^2 = 0.6945) est élevé. Cela signifie que la largeur du corps explique à 69.45% la variance de la longueur de la queue et donc que le modèle explique une grande partie de la variabilité.

-   L'effet est positif , fort et hautement significatif

-   L'ordonnée à l'origine (alpha = 46.56) est significative au seuil alpha de 5%

-   La pente ( beta = 2.11) est significative au seuil alpha de 5%. Cela signifie que pour chaque augmentation d'une unité de la largeur du corps, la longueur de la queue augmente en moyenne de 2.11 unités

-   La pente étant significative, ça valide le fait que comparer la longueur de la queue avec la largeur du corps entre elles est pertinent

-   Le modèle permet prédire efficacement la longueur de la queue àpd la largeur du corps

```{r lmx1Lea-Amelie}
chart(snake_lm1)
```

-   on observe une corrélation positive entre nos variables (plus la largeur du corps augmente, plus la longueur de la queue augmente aussi)

-   L'intervalle de confiance autour de la droite de régression est relativement étroite, surtout au milieu de celle-ci et ça nous indique que l'estimation de la relation est précise et fiable.

-   Il y a homoscédasticité car les points se distribuent de manière relativement homogène autour de la droite de régression. Le modèle est donc assez robuste.

-   Le nuage de point se décondense au niveau des valeurs extrêmes

```{r lmp1Lea-Amelie}
chart$residuals(snake_lm1)
```

...interprétation

#### Régression linéaire 2

<!--% Ajustez une régression linéaire simple, multiple ou polynomiale par paire d'étudiants dans cette section (donc, deux modèles pour l'équipe de quatre). -->

```{r}
snake_lm2 <- lm(data = sea_snake1, eye_diam ~ head_length)
tabularise(summary(snake_lm2))
```

...interpretation

```{r}
chart(snake_lm2)
```

...interpretation

```{r}
chart$residuals(snake_lm2)
```

...interpretation

#### Modèle linéaire 1

<!--% Construisez un modèle linéaire par paire d'étudiants dans cette section. -->

```{r model1Lea-Amelie}
snake1_lm <- lm(data = sea_snake1, tail_width_max~body_width)
summary(snake1_lm) |> tabularise()
```

...interpretation

```{r grapmodel1Lea-Amelie}
chart(snake1_lm)
```

...interpretation

```{r residuals1Lea-Amelie}
chart$residuals(snake1_lm)
```

...interpretation

#### Modèle linéaire 2

<!--% Construisez un modèle linéaire par paire d'étudiants dans cette section. -->

```{r model2Thea-Pierre}
snake2_lm <- lm(data = sea_snake1, eye_diam ~ (head_length + head_width) * sex)
summary_(snake2_lm)|>tabularise()
```

...interpretation

```{r graphmodel2Thea-Pierre}
#chart(snake2_lm) #on peut pas faire en 2D

#Si tu veux mettre un graphique en 3D c'est le code. Les femelles sont en bleu et les mâles en rose.
car::scatter3d(data = sea_snake1, eye_diam ~ (head_length + head_width) * sex,
  fit = "linear", residuals = TRUE, bg.col = "white", axis.scales = TRUE,
  grid = TRUE, ellipsoid = FALSE)
rgl::rglwidget(width = 800, height = 800)
```

...interpretation

```{r residuals2Thea-Pierre}
chart$residuals(snake2_lm)
```

interpretation...

#### Modèle linéaire généralisé et/ou mixte 1

<!--% Élaborez un modèle linéaire généralisé ou mixte par paire d'étudiants dans cette section. -->

```{r}
#GLM(M)1Lea-Amelie
#snake1_glm <- glm(data = sea_snake1, sex ~ tail_length , family = binomial)
#summary(snake1_glm) |>tabularise()
```

...interpretation

```{r}
# chartGLM(M)1Lea-Amelie
#chart(snake1_glm)
```

...interpretation

```{r}
# residualsGLM(M)1Lea-Amelie
#chart$residuals(snake1_glm)
```

...interpretation

#### Modèle linéaire généralisé et/ou mixte 2

<!--% Élaborez un modèle linéaire généralisé ou mixte par paire d'étudiants dans cette section. -->

```{r}
# GLM(M)2Thea-Pierre
snake_glm2 <- glm( data = sea_snake1, sex ~ eye_diam, family = binomial)
summary_(snake_glm2) |> tabularise()# transfo adult en facteur
```

La dispersion vaut 1.38 (506.7/386) alors que le paramètre de dispersion du modèle est fixé à 1. Nous sommes dans un cas de légère surdispersion.

Les deux paramètres sont significativement différent de 0 au seuil alpha de 5%.

```{r}
# 

```

...interpretation

```{r}
# 
```

...interpretation

## Conclusion

<!--% Lorsque toutes les analyses sont réalisées, terminez ce bloc-notes avec 3 à 6 phrases de conclusion en rapport avec ce que vous avez observé dans vos analyses. Quels sont les modèles les plus pertinents que vous retenez ? -->

...vos conclusions ici...

## Références

<!--% N'indiquez rien ci-dessous. Quarto se chargera de rajouter vos références bibliographiques automatiquement. -->
